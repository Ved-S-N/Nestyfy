<% layout("layouts/boilerplate") -%>
<body>
  <div class="row mt-3">
    <div class="col-8 offset-2">
      <form method="post" action="/listings/<%=listing._id%>?_method=PUT" class="needs-validation" novalidate enctype="multipart/form-data">
        
        <div class="mb-3">
          <label for="title" class="form-label for="title"">Title</label for="title">
          <input
            name="listing[title]"
            value="<%= listing.title%>"
            type="text"
            class="form-control"
            required
          />
          <div class="invalid-feedback">Title should be valid</div>
        </div>
        <div class="mb-3">
          <label for="description" class="form-label for="title"">Description</label for="title">
          <textarea required name="listing[description]" class="form-control"><%=listing.description%></textarea
          >
          <div class="invalid-feedback">description should be valid</div>
        </div>
        <div class="mb3">
          <img src="<%=originalImageUrl%>">
        </div>
        <div class="mb-3">
          <label for="image" class="form-label for="title"">Image Link</label for="title">
          <input
            name="listing[image]"
            type="file"
            class="form-control"
            
          />
          
        </div>
        <div class="row">
        <div class="mb-3 col-md-4">
          
          <label for="price" class="form-label for="title"">Price</label for="title">
          <input
            name="listing[price]"
            value="<%=listing.price%>"
            
            class="form-control"
            required
          /><div class="invalid-feedback">Price should be valid</div>
        </div>
        <div class="mb-3 col-md-8">
          <label for="country" class="form-label for="title"">Country</label for="title">
          <input
            name="listing[country]"
            value="<%=listing.country%>"
            type="text"
            required
            class="form-control"
          /><div class="invalid-feedback">Country name should be valid</div>
        </div>
        </div>
        <div class="mb-3">
          <label for="location" class="form-label for="title"">Location</label for="title">
          
            <input
            name="listing[location]"
            value="<%=listing.location%>"
            type="text"
            required
            class="form-control"
          /><div class="invalid-feedback">Location should be valid</div>
        </div>
        
  
  


<div id="map" style="height: 300px;" class="mb-3"></div>

        <button class="btn btn-dark update-btn mt-3 me-4">Update</button>
        <a class="btn btn-dark update-btn mt-3 " href="/listings/<%=listing._id%>">Cancel</a>
        <br><br>
      </form>
    </div>
  </div>
  <script>
  const lat = <%= listing.geometry?.coordinates[1] || 19.07 %>;
  const lng = <%= listing.geometry?.coordinates[0] || 72.87 %>;

  const map = L.map('map').setView([lat, lng], 13);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Â© OpenStreetMap contributors'
  }).addTo(map);

  const marker = L.marker([lat, lng]).addTo(map);
</script>

</body>
